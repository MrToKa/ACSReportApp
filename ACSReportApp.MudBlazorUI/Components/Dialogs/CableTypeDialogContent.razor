@using ACSReportApp.Models.Enums
@using ACSReportApp.Services.Models
@using MudBlazor

<EditForm Model="@CableType" OnValidSubmit="(() => OnValidSubmit.InvokeAsync())">
    <MudTextField @bind-Value="CableType.Type" Label="Cable Type" />
    <MudTextField @bind-Value="CableType.Description" Label="Cable Description" />
    <MudTextField @bind-Value="CableType.Purpose" Label="Cable Purpose" />
    <MudNumericField HideSpinButtons="true" @bind-Value="CableType.Voltage" Label="Cable Voltage [V]" />
    <MudNumericField HideSpinButtons="true" @bind-Value="CableType.Pairs" Label="Cable Pairs" />
    <MudNumericField HideSpinButtons="true" @bind-Value="CableType.Conductors" Label="Cable Conductors" />
    <MudSelect T="CableDelimiter?" @bind-Value="CableType.Delimiter" Label="Cable Delimiter">
        @foreach (var delimiter in CableDelimiters)
        {
            <MudSelectItem Value="@(delimiter.Value)">@GetDelimiterDisplayName(delimiter.Value)</MudSelectItem>
        }
    </MudSelect>
    <MudNumericField T="double" HideSpinButtons="true" @bind-Value="CableType.CrossSection" Label="Cable Cross Sections" />
    <MudSelect T="CableDelimiter?" @bind-Value="CableType.GroundingDelimiter" Label="Cable Grounding Cores Delimiter">
        @foreach (var delimiter in CableDelimiters)
        {
            <MudSelectItem Value="@(delimiter.Value)">@GetDelimiterDisplayName(delimiter.Value)</MudSelectItem>
        }
    </MudSelect>
    <MudNumericField HideSpinButtons="true" @bind-Value="CableType.PEConductors" Label="Cable PE Conductors" />
    <MudSelect T="CableDelimiter?" @bind-Value="CableType.PEDelimiter" Label="Cable PE Delimiter">
        @foreach (var delimiter in CableDelimiters)
        {
            <MudSelectItem Value="@(delimiter.Value)">@GetDelimiterDisplayName(delimiter.Value)</MudSelectItem>
        }
    </MudSelect>
    <MudNumericField T="double?" HideSpinButtons="true" @bind-Value="CableType.PECrossSection" Label="Cable PE Cross Section" />
    <MudNumericField HideSpinButtons="true" @bind-Value="CableType.Diameter" Label="Cable Diameter [mm²]" />
    <MudSelect @bind-Value="CableType.Shield" Label="Cable Shield">
        <MudSelectItem Value="@(true)">Yes</MudSelectItem>
        <MudSelectItem Value="@(false)">No</MudSelectItem>
    </MudSelect>
    <MudNumericField T="double?" HideSpinButtons="true" @bind-Value="CableType.BendingRadius" Label="Cable Bending Radius [mm]" />
    <MudNumericField T="double" HideSpinButtons="true" @bind-Value="CableType.WeightPerKm" Label="Cable Weight Per Km [kg/km]" />
    <MudTextField @bind-Value="CableType.Manufacturer" Label="Cable Manufacturer" />
    <MudTextField @bind-Value="CableType.PartNumber" Label="Cable Part Number" />
</EditForm>

@code {
    [Parameter] 
    public List<KeyValuePair<string, CableDelimiter?>> CableDelimiters { get; set; }

    [Parameter] 
    public EventCallback<string> OnValidSubmit { get; set; }

    [Parameter]
    public CableTypeServiceModel CableType { get; set; }

    private string GetDelimiterDisplayName(CableDelimiter? delimiter)
    {
        return delimiter.HasValue ? ((char)delimiter.Value).ToString() : string.Empty;
    }
}
